"use strict";(self.webpackChunknobleui_angular=self.webpackChunknobleui_angular||[]).push([[918],{1918:(ot,C,c)=>{c.r(C),c.d(C,{DpConsumptionModule:()=>it});var _=c(6895),h=c(4407),p=c(4931),m=c(433),t=c(4650),T=c(996),x=c(3361),r=c(9061),v=c(2038);function A(i,a){1&i&&(t.TgZ(0,"div",27),t._uU(1," Location is required !"),t.qZA())}function y(i,a){1&i&&(t.TgZ(0,"div"),t._uU(1,"Inhand items"),t.qZA())}function q(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",33)(1,"input",34),t.NdJ("ngModelChange",function(o){t.CHM(e);const s=t.oxw(2);return t.KtG(s.keyword=o)})("keyup",function(o){t.CHM(e);const s=t.oxw(2);return t.KtG(s.search(o,"Consumed"))}),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngModel",e.keyword)}}function U(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",39),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,s=t.oxw(4),u=t.MAs(43);return s.openBackDropCustomClass(u),t.KtG(s.SetConsumeItems(o))}),t._UZ(1,"i",40),t.TgZ(2,"span",41),t._uU(3,"Consume Item"),t.qZA()()}}function b(i,a){if(1&i&&(t.TgZ(0,"tr")(1,"td",36),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.ALo(17,"date"),t.qZA(),t.TgZ(18,"td"),t._uU(19),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.qZA(),t.TgZ(22,"td"),t._uU(23),t.qZA(),t.TgZ(24,"td"),t._uU(25),t.qZA(),t.TgZ(26,"th"),t._uU(27),t.qZA(),t.TgZ(28,"td"),t.YNc(29,U,4,0,"button",38),t.qZA()()),2&i){const e=a.$implicit;t.xp6(2),t.Oqu(e.ItemName),t.xp6(2),t.Oqu(e.VendorItemName?e.VendorItemName:"N/A"),t.xp6(2),t.Oqu(""==e.HsnCode?"N/A":e.HsnCode),t.xp6(2),t.Oqu(""==e.CatalogNo?"N/A":e.CatalogNo),t.xp6(2),t.hij("",""==e.MachineName?"N/A":e.MachineName," "),t.xp6(2),t.Oqu(e.MajorUnitName),t.xp6(2),t.Oqu(e.ManufactureName),t.xp6(2),t.Oqu("0001-01-01T00:00:00"==e.ExpiryDate?"N/A":t.xi3(17,14,e.ExpiryDate,"dd-MM-yyyy")),t.xp6(3),t.Oqu(e.ReceiveQty),t.xp6(2),t.Oqu(e.ConsumeQty-e.ReturnQuantity-e.ScrapQuantity),t.xp6(2),t.Oqu(e.DPConsumeQty),t.xp6(2),t.Oqu(e.ReturnQuantity),t.xp6(2),t.Oqu(e.BatchNumber),t.xp6(2),t.Q6J("ngIf",0==e.Status&&0==e.IsReturn&&e.ConsumeQty-e.ReturnQuantity-e.ScrapQuantity!=0&&e.ReceiveQty!=e.ScrapQuantity)}}function D(i,a){if(1&i&&(t.ynx(0),t.YNc(1,b,30,17,"tr",37),t.BQk()),2&i){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.consumedItems)}}function N(i,a){1&i&&(t.TgZ(0,"tr")(1,"td"),t._UZ(2,"div",42),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"div",42),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"div",42),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"div",42),t.qZA(),t.TgZ(9,"td"),t._UZ(10,"div",42),t.qZA(),t.TgZ(11,"td"),t._UZ(12,"div",42),t.qZA(),t.TgZ(13,"td"),t._UZ(14,"div",42),t.qZA(),t.TgZ(15,"td"),t._UZ(16,"div",42),t.qZA(),t.TgZ(17,"td"),t._UZ(18,"div",42),t.qZA(),t.TgZ(19,"td"),t._UZ(20,"div",42),t.qZA(),t.TgZ(21,"td"),t._UZ(22,"div",42),t.qZA(),t.TgZ(23,"td"),t._UZ(24,"div",42),t.qZA()())}const Z=function(){return[]};function Q(i,a){1&i&&(t.ynx(0),t.YNc(1,N,25,0,"tr",37),t.BQk()),2&i&&(t.xp6(1),t.Q6J("ngForOf",t.DdM(1,Z).constructor(3)))}function S(i,a){if(1&i&&(t.TgZ(0,"table",35)(1,"thead")(2,"tr")(3,"th",36),t._uU(4,"Item name"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Vendor Item name"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"HSN code"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Catalog No"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Machine name"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Major Unit name"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Manufacturer"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Expiry Date"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Receive qty"),t.qZA(),t.TgZ(21,"th"),t._uU(22,"Remaining qty"),t.qZA(),t.TgZ(23,"th"),t._uU(24,"Consume qty"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"Return qty"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"Batch Number"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Actions"),t.qZA()()(),t.TgZ(31,"tbody"),t.YNc(32,D,2,1,"ng-container",29),t.YNc(33,Q,2,2,"ng-container",29),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(32),t.Q6J("ngIf",!e.shimmerVisible),t.xp6(1),t.Q6J("ngIf",e.shimmerVisible)}}function L(i,a){1&i&&(t.ynx(0),t.TgZ(1,"div",43)(2,"div",44)(3,"div",45),t._UZ(4,"i",46),t.TgZ(5,"span"),t._uU(6,"No items found!"),t.qZA()()()(),t.BQk())}function G(i,a){1&i&&(t.ynx(0),t.TgZ(1,"div",43)(2,"div",44)(3,"div",45),t._UZ(4,"i",46),t.TgZ(5,"span"),t._uU(6,"Please select location!"),t.qZA()()()(),t.BQk())}function M(i,a){if(1&i&&(t.TgZ(0,"h6",28),t.YNc(1,y,2,0,"div",29),t.YNc(2,q,2,1,"div",30),t.qZA(),t.TgZ(3,"div",31),t.YNc(4,S,34,2,"table",32),t.YNc(5,L,7,0,"ng-container",29),t.YNc(6,G,7,0,"ng-container",29),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",""!=e.SelectedLocationGuid&&null!=e.SelectedLocationGuid&&"00000000-0000-0000-0000-000000000000"!=e.SelectedLocationGuid),t.xp6(1),t.Q6J("ngIf",""!=e.SelectedLocationGuid&&null!=e.SelectedLocationGuid&&"00000000-0000-0000-0000-000000000000"!=e.SelectedLocationGuid),t.xp6(2),t.Q6J("ngIf",""!=e.SelectedLocationGuid&&null!=e.SelectedLocationGuid&&"00000000-0000-0000-0000-000000000000"!=e.SelectedLocationGuid),t.xp6(1),t.Q6J("ngIf",0==(null==e.consumedItems?null:e.consumedItems.length)&&e.SelectedLocationGuid&&!e.IsShow&&!e.shimmerVisible),t.xp6(1),t.Q6J("ngIf",""==e.SelectedLocationGuid||"00000000-0000-0000-0000-000000000000"==e.SelectedLocationGuid||e.IsShow&&!e.shimmerVisible)}}function k(i,a){1&i&&(t.TgZ(0,"div"),t._uU(1,"Consume items"),t.qZA())}function O(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",33)(1,"input",34),t.NdJ("ngModelChange",function(o){t.CHM(e);const s=t.oxw(2);return t.KtG(s.keyword=o)})("keyup",function(o){t.CHM(e);const s=t.oxw(2);return t.KtG(s.search(o,"InHandItems"))}),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngModel",e.keyword)}}function F(i,a){1&i&&(t.TgZ(0,"span",50),t._uU(1,"Consumed"),t.qZA())}function J(i,a){1&i&&(t.TgZ(0,"span",27),t._uU(1,"Returned"),t.qZA())}function R(i,a){1&i&&(t.TgZ(0,"span",51),t._uU(1,"Partial Returned"),t.qZA())}function w(i,a){1&i&&(t.TgZ(0,"span",27),t._uU(1,"Scraped"),t.qZA())}function V(i,a){if(1&i&&(t.TgZ(0,"tr")(1,"td",36),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.ALo(17,"date"),t.qZA(),t.TgZ(18,"td"),t._uU(19),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.qZA(),t.TgZ(22,"td"),t._uU(23),t.qZA(),t.TgZ(24,"td"),t._uU(25),t.qZA(),t.TgZ(26,"th"),t._uU(27),t.qZA(),t.TgZ(28,"td"),t.YNc(29,F,2,0,"span",48),t.YNc(30,J,2,0,"span",15),t.YNc(31,R,2,0,"span",49),t.YNc(32,w,2,0,"span",15),t.qZA()()),2&i){const e=a.$implicit;t.xp6(2),t.Oqu(e.ItemName),t.xp6(2),t.Oqu(e.VendorItemName?e.VendorItemName:"N/A"),t.xp6(2),t.Oqu(""==e.HsnCode?"N/A":e.HsnCode),t.xp6(2),t.Oqu(""==e.CatalogNo?"N/A":e.CatalogNo),t.xp6(2),t.hij("",""==e.MachineName?"N/A":e.MachineName," "),t.xp6(2),t.Oqu(e.MajorUnitName),t.xp6(2),t.Oqu(e.ManufactureName),t.xp6(2),t.Oqu("0001-01-01T00:00:00"==e.ExpiryDate?"N/A":t.xi3(17,17,e.ExpiryDate,"dd-MM-yyyy")),t.xp6(3),t.Oqu(e.ReceiveQty),t.xp6(2),t.Oqu(e.ConsumeQty-e.ReturnQuantity-e.ScrapQuantity),t.xp6(2),t.Oqu(e.DPConsumeQty),t.xp6(2),t.Oqu(e.ReturnQuantity),t.xp6(2),t.Oqu(e.BatchNumber),t.xp6(2),t.Q6J("ngIf",1==e.Status||e.ConsumeQty-e.ScrapQuantity==0&&e.ReceiveQty!=e.ScrapQuantity),t.xp6(1),t.Q6J("ngIf",1==e.IsReturn),t.xp6(1),t.Q6J("ngIf",1==e.IspartialReturn&&e.ConsumeQty-e.ReturnQuantity-e.ScrapQuantity==0),t.xp6(1),t.Q6J("ngIf",1==e.IsItemScrap&&e.ReceiveQty==e.ScrapQuantity)}}function H(i,a){if(1&i&&(t.ynx(0),t.YNc(1,V,33,20,"tr",37),t.BQk()),2&i){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.inHandItems)}}function B(i,a){1&i&&(t.TgZ(0,"tr")(1,"td"),t._UZ(2,"div",42),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"div",42),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"div",42),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"div",42),t.qZA(),t.TgZ(9,"td"),t._UZ(10,"div",42),t.qZA(),t.TgZ(11,"td"),t._UZ(12,"div",42),t.qZA(),t.TgZ(13,"td"),t._UZ(14,"div",42),t.qZA(),t.TgZ(15,"td"),t._UZ(16,"div",42),t.qZA(),t.TgZ(17,"td"),t._UZ(18,"div",42),t.qZA(),t.TgZ(19,"td"),t._UZ(20,"div",42),t.qZA(),t.TgZ(21,"td"),t._UZ(22,"div",42),t.qZA(),t.TgZ(23,"td"),t._UZ(24,"div",42),t.qZA()())}function Y(i,a){1&i&&(t.ynx(0),t.YNc(1,B,25,0,"tr",37),t.BQk()),2&i&&(t.xp6(1),t.Q6J("ngForOf",t.DdM(1,Z).constructor(3)))}function E(i,a){if(1&i&&(t.TgZ(0,"table",35)(1,"thead",47)(2,"tr")(3,"th",36),t._uU(4,"Item name"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Vendor Item name"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"HSN code"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Catalog No"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Machine name"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Major Unit name"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Manufacturer"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Expiry Date"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Receive qty"),t.qZA(),t.TgZ(21,"th"),t._uU(22,"Remaining qty"),t.qZA(),t.TgZ(23,"th"),t._uU(24,"Consume qty"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"Return qty"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"Batch Number"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Actions"),t.qZA()()(),t.TgZ(31,"tbody"),t.YNc(32,H,2,1,"ng-container",29),t.YNc(33,Y,2,2,"ng-container",29),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(32),t.Q6J("ngIf",!e.shimmerVisible),t.xp6(1),t.Q6J("ngIf",e.shimmerVisible)}}function j(i,a){1&i&&(t.ynx(0),t.TgZ(1,"div",43)(2,"div",44)(3,"div",45),t._UZ(4,"i",46),t.TgZ(5,"span"),t._uU(6,"No items found!"),t.qZA()()()(),t.BQk())}function P(i,a){1&i&&(t.ynx(0),t.TgZ(1,"div",43)(2,"div",44)(3,"div",45),t._UZ(4,"i",46),t.TgZ(5,"span"),t._uU(6,"Please select location!"),t.qZA()()()(),t.BQk())}function K(i,a){if(1&i&&(t.TgZ(0,"h6",28),t.YNc(1,k,2,0,"div",29),t.YNc(2,O,2,1,"div",30),t.qZA(),t.TgZ(3,"div",31),t.YNc(4,E,34,2,"table",32),t.YNc(5,j,7,0,"ng-container",29),t.YNc(6,P,7,0,"ng-container",29),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",""!=e.SelectedLocationGuid&&null!=e.SelectedLocationGuid&&"00000000-0000-0000-0000-000000000000"!=e.SelectedLocationGuid),t.xp6(1),t.Q6J("ngIf",""!=e.SelectedLocationGuid&&null!=e.SelectedLocationGuid&&"00000000-0000-0000-0000-000000000000"!=e.SelectedLocationGuid),t.xp6(2),t.Q6J("ngIf",""!=e.SelectedLocationGuid&&null!=e.SelectedLocationGuid&&"00000000-0000-0000-0000-000000000000"!=e.SelectedLocationGuid),t.xp6(1),t.Q6J("ngIf",0==(null==e.inHandItems?null:e.inHandItems.length)&&e.SelectedLocationGuid&&!e.IsShow&&!e.shimmerVisible),t.xp6(1),t.Q6J("ngIf",""==e.SelectedLocationGuid||"00000000-0000-0000-0000-000000000000"==e.SelectedLocationGuid||e.IsShow&&!e.shimmerVisible)}}function z(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",61),t.ynx(1,62),t.TgZ(2,"td")(3,"input",63),t.NdJ("change",function(o){const s=t.CHM(e),u=s.$implicit,l=s.index,d=t.oxw(2);return t.KtG(d.Checkeditem(o,u,l))}),t.qZA()(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"date"),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td")(16,"input",64),t.NdJ("input",function(){const o=t.CHM(e),s=o.$implicit,u=o.index,l=t.oxw(2);return t.KtG(l.ChangeConsumeQuantity(s,u))})("keypress",function(o){return o.charCode>=48&&o.charCode<=57||46===o.charCode}),t.qZA()(),t.TgZ(17,"td")(18,"input",65),t.NdJ("ngModelChange",function(o){const u=t.CHM(e).index,l=t.oxw(2);return t.KtG(l.setvalidauion(o,u))})("input",function(){const o=t.CHM(e),s=o.$implicit,u=o.index,l=t.oxw(2);return t.KtG(l.ChangeConsume(s,u))}),t.qZA()(),t.TgZ(19,"td"),t._UZ(20,"input",66),t.qZA(),t.TgZ(21,"td"),t._UZ(22,"input",67),t.qZA(),t.TgZ(23,"td"),t._UZ(24,"textarea",68),t.qZA(),t.BQk(),t.qZA()}if(2&i){const e=a.index,n=t.oxw(2);let o,s,u,l,d,g,I,f;t.xp6(1),t.Q6J("formGroupName",e),t.xp6(4),t.hij("",null==(o=n.IndentItemsDetailForm.get("ConsumeDetailItems"))?null:o.value[e].ItemName," "),t.xp6(2),t.Oqu(null!=(s=n.IndentItemsDetailForm.get("ConsumeDetailItems"))&&s.value[e].VendorItemName?null==(s=n.IndentItemsDetailForm.get("ConsumeDetailItems"))?null:s.value[e].VendorItemName:"N/A"),t.xp6(2),t.hij("",null==(u=n.IndentItemsDetailForm.get("ConsumeDetailItems"))?null:u.value[e].BatchNumber," "),t.xp6(2),t.hij("","0001-01-01T00:00:00"==(null==(l=n.IndentItemsDetailForm.get("ConsumeDetailItems"))?null:l.value[e].ExpiryDate)?"N/A":t.xi3(12,11,null==(l=n.IndentItemsDetailForm.get("ConsumeDetailItems"))?null:l.value[e].ExpiryDate,"dd-MM-yyyy")," "),t.xp6(3),t.hij("",null==(d=n.IndentItemsDetailForm.get("ConsumeDetailItems"))?null:d.value[e].ReceiveQty," "),t.xp6(2),t.Q6J("max",null==(g=n.IndentItemsDetailForm.get("ConsumeDetailItems"))?null:g.value[e].oldConsumeQuantity),t.xp6(2),t.Q6J("value",null==(I=n.IndentItemsDetailForm.get("ConsumeDetailItems"))?null:I.value[e].Units),t.xp6(2),t.Q6J("min",0),t.xp6(2),t.Q6J("min",0),t.xp6(2),t.Q6J("value",null==(f=n.IndentItemsDetailForm.get("ConsumeDetailItems"))?null:f.value[e].ReasonForUse)}}function $(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",52)(1,"h5",53),t._uU(2,"Consume items"),t.qZA(),t.TgZ(3,"button",54),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw();return s.close("by: close icon"),t.KtG(u.ConsumeItemslist.clear())}),t.qZA()(),t.TgZ(4,"div",55)(5,"form",56)(6,"div",5)(7,"div",16)(8,"div",31)(9,"table",35)(10,"thead")(11,"tr")(12,"td"),t._uU(13,"#"),t.qZA(),t.TgZ(14,"td"),t._uU(15,"Item Name"),t.qZA(),t.TgZ(16,"td"),t._uU(17,"Vendor Item Name"),t.qZA(),t.TgZ(18,"td"),t._uU(19,"Batch Number"),t.qZA(),t.TgZ(20,"td"),t._uU(21,"Expiry Date"),t.qZA(),t.TgZ(22,"td"),t._uU(23,"Received Quantity"),t.qZA(),t.TgZ(24,"td"),t._uU(25,"Consume Quantity"),t.qZA(),t.TgZ(26,"td"),t._uU(27,"Units"),t.qZA(),t.TgZ(28,"td"),t._uU(29,"On Board Stock"),t.qZA(),t.TgZ(30,"td"),t._uU(31,"On Hand Stock"),t.qZA(),t.TgZ(32,"td"),t._uU(33,"Reason For Use"),t.qZA()()(),t.TgZ(34,"tbody"),t.YNc(35,z,25,14,"tr",57),t.qZA()()()()()()(),t.TgZ(36,"div",58)(37,"button",59),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw();return s.close("by: cancel button"),t.KtG(u.ConsumeItemslist.clear())}),t._uU(38,"Cancel"),t.qZA(),t.TgZ(39,"button",60),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw();return s.close("by: Save button"),t.KtG(u.SaveConsumeItems())}),t._uU(40,"Save"),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(5),t.Q6J("formGroup",e.IndentItemsDetailForm),t.xp6(30),t.Q6J("ngForOf",e.ConsumeItemslist.controls),t.xp6(4),t.Q6J("disabled",!e.isAnyValueFilled||1==e.isQuantityCheck)}}const X=function(i){return{"text-danger":i}},W=function(){return{maxlength:"50"}},tt=[{path:"",component:(()=>{class i{constructor(e,n,o,s,u){this.indentService=e,this.purchaseOrderService=n,this.modalService=o,this.fb=s,this.authservice=u,this.defaultNavActiveId=1,this.SelectedLocationGuid=[],this.IndentItemsDetailForm={},this.ConsumeDetailItems={},this.Consumeitemslist=[],this.IsShow=!0,this.isQuantityCheck=!1,this.consumedItems=[],this.inHandItems=[],this.allinHandItems=[],this.allConsumedItems=[],this.keyword="",this.isAnyValueFilled=!1}ngOnInit(){this.UserGuid=localStorage.getItem("UserGuid")||"",this.GetLocationsByDefault(),this.intForm(),this.ConsumeItemslist.removeAt(this.index=0);let e=this.authservice.LoggedInUser.LOCATIONSGUID?.toLowerCase();(e||0==this.authservice.LoggedInUser.STORE)&&(this.SelectedLocationGuid="00000000-0000-0000-0000-000000000000"==e||e.split(",").length>1?[]:e,this.GetReceivedItemsDetails(e))}intForm(){this.IndentItemsDetailForm=this.fb.group({ConsumeDetailItems:this.fb.array([this.fb.group({ItemName:[""],VendorItemName:[""],ItemGuid:[""],BatchNumber:[""],ConsumeQuantity:[0,[m.kI.required]],ReasonForUse:[""],Units:[""],ReceiveQty:[""],IndentNo:[""],oldConsumeQuantity:[""],oldUnits:[""],Checked:[!1],OnBoardStock:[0],OnHandStock:[0]})])})}get ConsumeItemslist(){return this.IndentItemsDetailForm.get("ConsumeDetailItems")}openBackDropCustomClass(e){this.modalService.open(e,{backdrop:"static",keyboard:!1,size:"xl"})}GetLocationsByDefault(){let e=this.authservice.LoggedInUser.DEFAULTROLES.toLowerCase().includes("ADMIN".toLowerCase())&&"00000000-0000-0000-0000-000000000000"==this.authservice.LoggedInUser.LOCATIONSGUID?"00000000-0000-0000-0000-000000000000":this.authservice.LoggedInUser.LOCATIONSGUID.split(",");this.shimmerVisible=!0,this.purchaseOrderService.GetPOAgainstPIPostDefaults(e).subscribe(n=>{this.CenterLocation=n.Result.LstCenterLocations,this.shimmerVisible=!1},n=>{this.shimmerVisible=!1})}SelectLocation(e){this.SelectedLocationGuid=e?.LocationGuid,this.consumedItems=[],this.inHandItems=[],this.allinHandItems=[],this.allConsumedItems=[],null!=e?this.GetReceivedItemsDetails(e.LocationGuid):(this.ReceivedItems=[],this.SelectedLocationGuid=[],this.IsShow=!0)}GetReceivedItemsDetails(e){this.keyword="",this.consumedItems=[],this.allConsumedItems=[],this.shimmerVisible=!0,this.indentService.GetReceivedItemsDetails(e).subscribe(n=>{this.IsShow="00000000-0000-0000-0000-000000000000"==e,this.ReceivedItems=n.Result,this.ReceivedItems.forEach(o=>{0==o.Status&&0==o.IsReturn&&o.ConsumeQty-o.ReturnQuantity-o.ScrapQuantity!=0&&o.ReceiveQty!=o.ScrapQuantity?(this.consumedItems.push(o),this.allConsumedItems.push(o)):(this.inHandItems.push(o),this.allinHandItems.push(o))}),this.IsShow=!1,this.shimmerVisible=!1},n=>{this.shimmerVisible=!1})}SetConsumeItems(e){this.Consumeitemslist=this.ReceivedItems.filter(n=>n.ItemGuid===e.ItemGuid&&n.BatchNumber===e.BatchNumber&&n.IndentNo===e.IndentNo),this.Consumeitemslist.forEach(n=>{const o=n.ConsumeQty-n.ReturnQuantity-n.ScrapQuantity;o>0&&this.ConsumeItemslist.push(this.fb.group({ItemName:n.ItemName,VendorItemName:n.VendorItemName,BatchNumber:n.BatchNumber,ItemGuid:n.ItemGuid,ConsumeQuantity:[o,[m.kI.required]],ReasonForUse:"",Units:o*n.IssueMultiplier,ReceiveQty:n.ReceiveQty,IndentNo:n.IndentNo,oldConsumeQuantity:o,oldUnits:o*n.IssueMultiplier,IndentGuid:n.IndentGuid,ExpiryDate:n.ExpiryDate,Checked:!1,OnHandStock:n.OnHandStock,OnBoardStock:n.OnBoardStock}))}),this.listenToFormChanges()}SaveConsumeItems(){this.ConsumeItemslist.value.forEach((o,s)=>{this.ConsumeItemslist.at(s).patchValue({ReasonForUse:o.ReasonForUse,Units:o.Units})});const e=this.IndentItemsDetailForm.value.ConsumeDetailItems.filter(o=>!0===o.Checked);let n={userGuid:this.UserGuid,LstConsumeItems:e};this.shimmerVisible=!0,this.indentService.SaveConsumeDetails(n).subscribe(o=>{this.inHandItems=[],this.consumedItems=[],this.GetReceivedItemsDetails(this.SelectedLocationGuid),this.ConsumeItemslist.clear(),this.IndentItemsDetailForm.reset(),this.shimmerVisible=!1},o=>{this.shimmerVisible=!1})}ChangeConsumeQuantity(e,n){if(0==this.IndentItemsDetailForm.get("ConsumeDetailItems")?.value[n].ConsumeQuantity)this.isQuantityCheck=!0;else if(this.IndentItemsDetailForm.get("ConsumeDetailItems")?.value[n].ConsumeQuantity>this.IndentItemsDetailForm.get("ConsumeDetailItems")?.value[n].oldConsumeQuantity)this.ConsumeItemslist.at(n).patchValue({ConsumeQuantity:this.IndentItemsDetailForm.get("ConsumeDetailItems")?.value[n].oldConsumeQuantity,Units:this.IndentItemsDetailForm.get("ConsumeDetailItems")?.value[n].oldUnits}),this.isQuantityCheck=!1;else{const s=this.IndentItemsDetailForm.get("ConsumeDetailItems")?.value[n].ConsumeQuantity*this.Consumeitemslist[n].IssueMultiplier;this.ConsumeItemslist.value.forEach((u,l)=>{this.ConsumeItemslist.at(n).patchValue({Units:s})}),this.isQuantityCheck=!1}}ChangeConsume(e,n){const o=this.IndentItemsDetailForm.get("ConsumeDetailItems")?.value[n].Units,u=this.Consumeitemslist[n].ConsumeQty-(this.Consumeitemslist[n].ConsumeQty*this.Consumeitemslist[n].IssueMultiplier-o)/this.Consumeitemslist[n].IssueMultiplier;this.ConsumeItemslist.value.forEach((l,d)=>{this.ConsumeItemslist.at(n).patchValue({ConsumeQuantity:u})})}setvalidauion(e,n){this.IndentItemsDetailForm.get("ConsumeDetailItems."+n+".Units")?.setValue(!e||e<=0||(this.Consumeitemslist[n].ConsumeQty-this.Consumeitemslist[n].ReturnQuantity)*this.Consumeitemslist[n].IssueMultiplier<e?(this.Consumeitemslist[n].ConsumeQty-this.Consumeitemslist[n].ReturnQuantity)*this.Consumeitemslist[n].IssueMultiplier:e)}search(e,n){this.consumedItems="Consumed"==n&&""!=e.target.value?this.allConsumedItems?.filter(o=>o.ItemName.toLowerCase().includes(e.target.value.toLowerCase())||o.BatchNumber.toLowerCase().includes(e.target.value.toLowerCase())):this.allConsumedItems,this.inHandItems="InHandItems"==n&&""!=e.target.value?this.allinHandItems?.filter(o=>o.ItemName.toLowerCase().includes(e.target.value.toLowerCase())||o.BatchNumber.toLowerCase().includes(e.target.value.toLowerCase())):this.allinHandItems}filterItems(e){this.keyword="","InHandItems"==e?this.inHandItems=this.allinHandItems:this.consumedItems=this.allConsumedItems}Checkeditem(e,n,o){const s=e.target.checked;this.ConsumeItemslist.controls.forEach((u,l)=>{l===o&&u.patchValue({Checked:s})})}listenToFormChanges(){this.IndentItemsDetailForm.get("ConsumeDetailItems")?.valueChanges.subscribe(e=>{this.isAnyValueFilled=e.some(n=>!!n.Checked)})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(T.N),t.Y36(x.x),t.Y36(r.FF),t.Y36(m.qu),t.Y36(v.$))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-dp-consumption"]],decls:44,vars:14,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/dp-consumption"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card"],[1,"card-body"],[1,"col-12","col-md-4","col-lg-3"],[1,"mb-3"],["for","manufacturerName",1,"form-label"],[3,"ngClass"],["placeholder","search by location","name","SelectedLocationGuid","required","","bindValue","LocationGuid","bindLabel","LocationName",1,"ng-select-custom-250min",3,"notFoundText","ngModel","inputAttrs","ngClass","items","ngModelChange","change"],["name","ngModel"],["class","text-danger",4,"ngIf"],[1,"col-sm-12"],[1,"card-title"],[1,"card-body","p-0"],[1,"example"],["ngbNav","",1,"nav-tabs",3,"activeId","activeIdChange"],["defaultNav","ngbNav"],[3,"ngbNavItem"],["ngbNavLink","",3,"click"],["ngbNavContent",""],[1,"border","border-top-0","p-3",3,"ngbNavOutlet"],["ConsumeItems",""],[1,"text-danger"],[1,"card-title","d-flex","align-items-center","justify-content-between"],[4,"ngIf"],["class","d-flex align-items-center text-end",4,"ngIf"],[1,"table-responsive"],["class","table bg-white",4,"ngIf"],[1,"d-flex","align-items-center","text-end"],["type","text","placeholder","Search","maxlength","48",1,"form-control","form-select-sm",3,"ngModel","ngModelChange","keyup"],[1,"table","bg-white"],[1,"freeze-col"],[4,"ngFor","ngForOf"],["type","button","class","btn btn-outline-primary btn-icon-text",3,"click",4,"ngIf"],["type","button",1,"btn","btn-outline-primary","btn-icon-text",3,"click"],[1,"feather","icon-shopping-bag","link-icon","me-1"],[1,"vertical-align-middle"],[1,"shimmerBG","line"],[1,"minh-fullscreen","d-flex","align-items-center","justify-content-center"],[1,"py-5","text-muted"],[1,"d-flex","flex-column","justify-content-center","gap-1","align-items-center","fs-4"],[1,"feather","icon-alert-circle","fs-2"],[2,"position","sticky","top","0","background-color","#fff","box-shadow","0px 2px 4px rgba(0, 0, 0, 0.1)","z-index","12"],["class","text-success",4,"ngIf"],["class","text-info",4,"ngIf"],[1,"text-success"],[1,"text-info"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],["formArrayName","ConsumeDetailItems",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["formArrayName","ConsumeDetailItems"],[3,"formGroupName"],["type","checkbox",3,"change"],["min","0","formControlName","ConsumeQuantity","type","number",1,"form-control",2,"width","100px",3,"max","input","keypress"],["formControlName","Units","type","text",1,"form-control",2,"width","100px",3,"value","ngModelChange","input"],["type","number","formControlName","OnBoardStock",1,"form-control",3,"min"],["type","number","formControlName","OnHandStock",1,"form-control",3,"min"],["formControlName","ReasonForUse",1,"form-control","h-38",3,"value"]],template:function(e,n){if(1&e&&(t.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),t._uU(4,"DP consumption"),t.qZA()(),t.TgZ(5,"li",4),t._uU(6,"DP consumption"),t.qZA()()(),t.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",5)(12,"div",9)(13,"div",10)(14,"label",11),t._uU(15," Locations"),t.TgZ(16,"span",12),t._uU(17," *"),t.qZA()(),t.TgZ(18,"ng-select",13,14),t.NdJ("ngModelChange",function(s){return n.SelectedLocationGuid=s})("change",function(s){return n.SelectLocation(s)}),t.qZA(),t.YNc(20,A,2,0,"div",15),t.qZA()(),t.TgZ(21,"div",16),t._UZ(22,"hr"),t.qZA()(),t.TgZ(23,"h6",17),t._uU(24,"Item Details"),t.qZA(),t.TgZ(25,"div",5)(26,"div",6)(27,"div",7)(28,"div",18),t.ynx(29),t.TgZ(30,"div",19)(31,"ul",20,21),t.NdJ("activeIdChange",function(s){return n.defaultNavActiveId=s}),t.TgZ(33,"li",22)(34,"a",23),t.NdJ("click",function(){return n.filterItems("InHandItems")}),t._uU(35,"Inhand items"),t.qZA(),t.YNc(36,M,7,5,"ng-template",24),t.qZA(),t.TgZ(37,"li",22)(38,"a",23),t.NdJ("click",function(){return n.filterItems("Consumed")}),t._uU(39,"Consumed items"),t.qZA(),t.YNc(40,K,7,5,"ng-template",24),t.qZA()(),t._UZ(41,"div",25),t.qZA(),t.BQk(),t.qZA()()()()()()()(),t.YNc(42,$,41,3,"ng-template",null,26,t.W1O)),2&e){const o=t.MAs(19),s=t.MAs(32);t.xp6(16),t.Q6J("ngClass",t.VKq(11,X,""==n.SelectedLocationGuid||null==n.SelectedLocationGuid)),t.xp6(2),t.Q6J("notFoundText","No location found!")("ngModel",n.SelectedLocationGuid)("inputAttrs",t.DdM(13,W))("ngClass",""!=n.SelectedLocationGuid&&null!=n.SelectedLocationGuid||null==o||!o.touched?"":"is-invalid")("items",n.CenterLocation),t.xp6(2),t.Q6J("ngIf",""!=n.SelectedLocationGuid&&null!=n.SelectedLocationGuid||null==o||!o.touched?"":"is-invalid"),t.xp6(11),t.Q6J("activeId",n.defaultNavActiveId),t.xp6(2),t.Q6J("ngbNavItem",1),t.xp6(4),t.Q6J("ngbNavItem",2),t.xp6(4),t.Q6J("ngbNavOutlet",s)}},dependencies:[_.mk,_.sg,_.O5,p.yS,h.w9,m._Y,m.Fj,m.wV,m.JJ,m.JL,m.Q7,m.nD,m.qQ,m.Fd,m.On,m.sg,m.u,m.x0,m.CE,r.uN,r.Pz,r.nv,r.Vx,r.tO,_.uU],styles:[".h-38[_ngcontent-%COMP%]{height:38px}.freeze-col[_ngcontent-%COMP%]{position:sticky;left:0;width:150px;min-width:150px;z-index:2;background:#fff}.pi-items.row[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding-left:0!important}"]}),i})()}];let et=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[p.Bz.forChild(tt),p.Bz]}),i})();var nt=c(8395);let it=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[_.ez,et,h.A0,m.u5,m.UX,nt.m,r.IJ]}),i})()}}]);