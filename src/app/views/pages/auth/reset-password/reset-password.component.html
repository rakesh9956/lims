<div class="row w-100 mx-0 auth-page">
  <div class="col-md-8 col-xl-6 mx-auto">
    <div class="card">
      <div class="row">
        <div class="col-md-4 pe-md-0">
          <div class="auth-side-wrapper"
            [ngStyle]="{ 'background-image': 'url(https://envato-shoebox-0.imgix.net/74ba/3a90-2bd9-40aa-b98a-0a59bed5a2a8/1684826.jpg?auto=compress%2Cformat&fit=max&mark=https%3A%2F%2Felements-assets.envato.com%2Fstatic%2Fwatermark2.png&markalign=center%2Cmiddle&markalpha=18&w=900&s=0b54183e4f255df22111b20670158bf8)' }">

          </div>
        </div>
        <div class="col-md-8 ps-md-0">
          <div class="auth-form-wrapper px-4 py-5">
            <a routerLink="." class="nobleui-logo d-block mb-2">Yoda <span>LIMS</span></a>
            <h5 class="text-muted fw-normal mb-4">Reset password.</h5>
            <form [formGroup]="confirmForm">
              <div class="row">
                <div  class="mb-3">
                  <label class="label-title">New password <span
                      [ngClass]="{'text-danger': getPassword.length == 0 }">
                      *</span></label>
                  <div class="position-relative">
                    <div class="position-relative password-visibility-block">
                      <div [class.alignment-class]="isPasswordInvalid"></div>
                      <input id="password" [type]="isNpVisible ? 'text' : 'password'" name="password" value=""
                        placeholder="Enter new password" formControlName="password" class="form-control login-input"
                        minlength="8" maxlength="16"
                        [ngClass]="(confirmForm.get('password')?.hasError('required'))&& confirmForm.get('password')?.touched ||  (confirmForm.value.password.length<8 && confirmForm.value.password!='') ?'is-invalid': ''">
                        <span  class="text-danger mt-4px d-block"
                        *ngIf="confirmForm.get('password')?.hasError('required') && confirmForm.get('password')?.touched">
                        New password is required!
                     </span>
                      <button class="btn password-visibility-icon" type="button"
                        (click)="toggleNpVisibility()">
                        <ng-container *ngIf="isNpVisible; else isNotVisible">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">
                            <path fill="none" d="M0 0h24v24H0z" />
                            <path
                              d="M12 3c5.392 0 9.878 3.88 10.819 9-.94 5.12-5.427 9-10.819 9-5.392 0-9.878-3.88-10.819-9C2.121 6.88 6.608 3 12 3zm0 16a9.005 9.005 0 0 0 8.777-7 9.005 9.005 0 0 0-17.554 0A9.005 9.005 0 0 0 12 19zm0-2.5a4.5 4.5 0 1 1 0-9 4.5 4.5 0 0 1 0 9zm0-2a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"
                              fill="rgba(143,143,143,1)" />
                          </svg>
                        </ng-container>
                        <ng-template #isNotVisible>
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">
                            <path fill="none" d="M0 0h24v24H0z" />
                            <path
                              d="M17.882 19.297A10.949 10.949 0 0 1 12 21c-5.392 0-9.878-3.88-10.819-9a10.982 10.982 0 0 1 3.34-6.066L1.392 2.808l1.415-1.415 19.799 19.8-1.415 1.414-3.31-3.31zM5.935 7.35A8.965 8.965 0 0 0 3.223 12a9.005 9.005 0 0 0 13.201 5.838l-2.028-2.028A4.5 4.5 0 0 1 8.19 9.604L5.935 7.35zm6.979 6.978l-3.242-3.242a2.5 2.5 0 0 0 3.241 3.241zm7.893 2.264l-1.431-1.43A8.935 8.935 0 0 0 20.777 12 9.005 9.005 0 0 0 9.552 5.338L7.974 3.76C9.221 3.27 10.58 3 12 3c5.392 0 9.878 3.88 10.819 9a10.947 10.947 0 0 1-2.012 4.592zm-9.084-9.084a4.5 4.5 0 0 1 4.769 4.769l-4.77-4.769z"
                              fill="rgba(143,143,143,1)" />
                          </svg>
                        </ng-template>
                      </button>
                      <div class="pwValidPopover">
                        <div class="pwValidPopover_Header">Passwords must be at least eight characters long and
                          contain at least one lowercase letter, one uppercase letter, one number, and one special
                          character.</div>
                        <span></span>
                        <div class="pwValidPopover_Body">
                          <ul class="pwValidPopover_Body_list">
                            <li
                              [ngClass]="{'active':!f['password'].hasError('hasSmallCase')&& (f['password'].dirty||f['password'].touched)&&f['password'].value}">
                              <span></span> Lowercase letter
                            </li>
                            <li
                              [ngClass]="{'active':!f['password'].hasError('hasCapitalCase')&& (f['password'].dirty||f['password'].touched)&&f['password'].value}">
                              <span></span> Uppercase letter
                            </li>
                            <li
                              [ngClass]="{'active':!f['password'].hasError('hasNumber')&& (f['password'].dirty||f['password'].touched)&& f['password'].value}">
                              <span></span> Number
                            </li>
                            <li
                              [ngClass]="{'active':!f['password'].hasError('hasSpecialCharacter')&& (f['password'].dirty||f['password'].touched)&&f['password'].value}">
                              <span></span> Special character
                            </li>
                            <li
                              [ngClass]="{'active':!f['password'].errors?.minlength && (f['password'].dirty||f['password'].touched)&&f['password'].value}">
                              <span></span> # of characters
                            </li>
                          </ul>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="f['password'].errors?.minlength" class="text-danger mt-4px d-block">
                      Password must be at least 8 characters!
                    </div>
                    <span class="text-danger mt-4px d-block"
                      *ngIf="!confirmForm.get('password')?.hasError('required') && confirmForm.get('password')?.invalid && !f['password'].errors?.minlength">
                      Password is invalid!
                    </span>

                  </div>
                </div>
              </div>


              <div class="mb-3">
                <label for="confirmPassword" class="form-label">Confirm password <span
                  [ngClass]="{'text-danger': getConfirmPassword.length == 0 }">*</span></label>
                <input [type]="isNpVisible ? 'text' : 'password'"  class="form-control" id="confirmPassword" 
                placeholder="Re-enter new password"  formControlName="confirmPassword"
                [ngClass]="{'is-invalid':f['confirmPassword'].hasError('notEquivalent') && f['confirmPassword'].value && f['confirmPassword'].touched,'is-valid':(!f['confirmPassword'].errors && f['confirmPassword'].touched && f['confirmPassword'].value)}"
                  >
                <div class="invalid-feedback"
                  [ngClass]="{'d-block':f['confirmPassword'].hasError('notEquivalent')&&(f['confirmPassword'].touched)&& f['confirmPassword'].value}">
                  Password and confirm password must match!
                </div>
                <div class="col-md-12 mt-2 col-12 p-0" *ngIf="PasswordCheck==true">
                  <div class="alert alert-danger">{{errorMessage}}</div>
                </div>
              </div>
              <div>
                <div>
                  <span>{{messageText}}</span>
                </div>
                <button type="submit" class="btn btn-primary me-2 mb-2 mb-md-0" [disabled]="confirmForm.invalid"
                  (click)="updatePassword()" >Submit</button>
              </div>
              <a routerLink="/auth/login" class="d-inline-block mt-3 text-muted">Back to Login</a>
              <!-- <a routerLink="/auth/forgot-password" class="d-block mt-3 text-muted">Forgot Password</a> -->
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>