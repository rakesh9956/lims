<nav class="page-breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a routerLink="/requests">Indents</a></li>
        <li class="breadcrumb-item active" aria-current="page">{{IndentGuid?'Edit Indent':'Add Indent'}}
    </ol>
</nav>

<div class="display-options-container position-relative">
    <a class="btn pt-0 pl-0 d-inline-block d-md-none c-pointer" data-toggle="collapse" role="button"
        aria-expanded="true" aria-controls="displayOptions">
        Filters {{ " " }}
        <i class="simple-icon-arrow-down align-middle"></i>
    </a>
    <div id="displayOptions" class="collapse dont-collapse-sm">
        <div class="d-flex flex-column flex-sm-row justify-content-sm-between">
            <div class="d-flex flex-column flex-sm-row">
                <div class="select-sm float-md-left mr-1 mb-1 align-top" dropdown>
                    <button id="orderby-button" dropdownToggle type="button"
                        class="btn btn-outline-dark btn-xs dropdown-toggle" aria-controls="dropdown-basic">
                        Order by : <span class="caret"></span>
                    </button>
                    <ul id="dropdown-basic" *dropdownMenu class="dropdown-menu" role="menu"
                        aria-labelledby="button-basic">
                        <li role="menuitem">
                            <a> </a>
                        </li>
                    </ul>
                </div>


                <div class="d-inline-block">
                    <div class="search-sm d-inline-block float-md-left mr-1 mb-1 align-top">
                        <input class="form-control" id="search" placeholder="Search" />
                    </div>
                </div>
            </div>

            <div class="text-right" id="pageCountDatatable">
                <span class="text-muted text-small mr-2"> </span>
                <span class="text-muted text-small mr-2"> </span>
                <span dropdown class="d-inline-block position-relative">
                    <button class="btn btn-outline-dark btn-xs dropdown-toggle" id="sortButton" type="button"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" dropdownToggle>

                    </button>
                    <div class="dropdown-menu dropdown-menu-right dropdown-menu-sm text-right" *dropdownMenu>
                        <li role="menuitem">
                            <a> </a>
                        </li>
                    </div>
                </span>
            </div>
        </div>
    </div>
    <div class="separator mb-4 mt-1"></div>
</div>
<div class="row">
    <div class="col-md-12 stretch-card">
        <div class="card">
            <div class="card-body">
                <h6 class="card-title">Request Details</h6>
                <form [formGroup]="indentForm">
                    <ng-container *ngIf="!shimmerVisible">
                        <div class="row">
                            <div class="col-lg-9">
                                <div class="row">
                                    <div class="mb-3" *ngIf="IndentGuid">
                                        <label for="IndentNo" class="form-label">IndentNo: 
                                            <strong>{{this.IndentItemDetails[0]?.IndentNo}}</strong></label>
                                    </div>   
                                    <div class="col-sm-12 align-items-end">
                                        <label class="form-check-label mb-2" for="itemFIFOorder">
                                            Indent Type
                                            <span [ngClass]="{'text-danger': !indentForm.value.IndentType}">*</span>
                                        </label>
                                        <div class="mb-3 d-flex ">
                                            <div class="form-check mr-2 mb-2"
                                                *ngIf="siRoles.toLowerCase().includes('Maker'.toLowerCase()) ">
                                                <input type="radio" class="form-check-input" name="IndentType"
                                                    value="SI" [attr.disabled]="this.IndentGuid?true:null"
                                                    id="indentTypeSI" formControlName="IndentType"
                                                    [checked]="this.indentForm.value.IndentType=='SI'"
                                                    >
                                                <label class="form-check-label" for="indentTypeSI">
                                                    SI
                                                </label>
                                            </div>
                                            <div class="form-check mb-2"
                                                *ngIf="roles.toLowerCase().includes('Maker'.toLowerCase())">
                                                <input type="radio" class="form-check-input" name="IndentType"
                                                    value="PI" [attr.disabled]="this.IndentGuid?true:null"
                                                    id="indentTypePI1" formControlName="IndentType" (change)="onChangeIndentType()"
                                                    [checked]="this.indentForm.value.IndentType=='PI'">
                                                <label class="form-check-label" for="indentTypePI1">
                                                    PI
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="mb-3">
                                            <label for="categoryType" class="form-label">Current location <span
                                                    [ngClass]="{'text-danger': !indentForm.value.CurrentLocationGuid}">*</span></label>
                                            <ng-select [items]="lstIndentLocation" [closeOnSelect]="true"
                                                [searchable]="true" [readonly]="IndentGuid" bindLabel="Location"
                                                bindValue="LocationGuid" placeholder="Select current location"
                                                (change)="OnselectStore($event)" formControlName="CurrentLocationGuid"
                                                [notFoundText]="'No location found!'"
                                                [ngClass]="{'is-invalid':indentForm.get('CurrentLocationGuid')?.hasError('required') && indentForm.get('CurrentLocationGuid')?.touched}">
                                            </ng-select>
                                            <div
                                                *ngIf="indentForm.get('CurrentLocationGuid')?.hasError('required') && indentForm.get('CurrentLocationGuid')?.touched">
                                                <span class="text-danger mt-4px d-block">Current Location is
                                                    required!</span>
                                            </div>

                                        </div>
                                    </div>
                                    <!-- <div class="col-sm-6 align-items-end">
                                        <label class="form-check-label mb-2" for="itemFIFOorder">
                                            Search Option
                                        </label>
                                        <div class="mb-3 d-flex ">
                                            <div class="form-check mr-2 mb-2">
                                                <input type="radio" class="form-check-input" id="itemFIFOorder">
                                                <label class="form-check-label" for="itemFIFOorder">
                                                    By First Name
                                                </label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input type="radio" class="form-check-input" id="itemFIFOorder">
                                                <label class="form-check-label" for="itemFIFOorder">
                                                    In Between
                                                </label>
                                            </div>
                                        </div>
                                    </div> -->
                                    <div class="col-sm-6">
                                        <div class="mb-3">
                                            <label for="categoryType" class="form-label">Indent location <span
                                                    [ngClass]="{'text-danger': !indentForm.value.RequestLocationGuid}">*</span></label>
                                            <ng-select [items]="lsttLocationsstore" [closeOnSelect]="true"
                                                [searchable]="true" [readonly]="IndentGuid" bindLabel="Location"
                                                bindValue="LocationGuid" placeholder="Select indent location"
                                                formControlName="RequestLocationGuid"
                                                (change)="OnLocationSelected();OnSelectIndentType(indentForm.value.RequestLocationGuid)"
                                                [notFoundText]="'No location found!'"
                                                [ngClass]="{'is-invalid':indentForm.get('RequestLocationGuid')?.hasError('required') && indentForm.get('RequestLocationGuid')?.touched}">
                                            </ng-select>
                                            <div
                                                *ngIf="indentForm.get('RequestLocationGuid')?.hasError('required') && indentForm.get('RequestLocationGuid')?.touched">
                                                <span class="text-danger mt-4px d-block">Indent Location is
                                                    required!</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6"
                                        *ngIf="this.indentForm.value.IndentType=='PI' && (authservice.LoggedInUser.STORE==true || authservice.LoggedInUser.STORE=='true') ">
                                        <div class="mb-3">
                                            <label for="categoryType" class="form-label">Active SI's </label>
                                            <ng-select [items]="SIApprovedDetail" [closeOnSelect]="true" [multiple]=true
                                                (add)="OnSelectSIItems($event)" (clear)="onSelectClose()"
                                                [searchable]="true" bindLabel="IndentNo" placeholder="Select active si"
                                                [notFoundText]="'No active SI found!'" (remove)="Onremove($event)"
                                                [clearOnBackspace]="true" #ngSelectComponent
                                                [(ngModel)]="SelectedSIItem" [ngModelOptions]="{standalone: true}">
                                            </ng-select>
                                        </div>
                                    </div>
                                    <!-- <div class="col-sm-6">
                                        <div class="mb-3">
                                            <label for="categoryType"
                                                class="form-label d-flex justify-content-between">Category</label>
                                            <select class="form-select" id="categoryType" formControlName="categoryType"
                                                [ngClass]="(indentForm.get('categoryType')?.hasError('required')) && indentForm.get('categoryType')?.touched ? 'is-invalid' : ''">
                                                <option value=null selected disabled>Select category type</option>
                                                <option *ngFor="let categorytype of lstCategoryType"
                                                    [value]="categorytype.CategoryGuid">{{categorytype.CategoryTypeName}}
                                                </option>
                                            </select>
                                            <div
                                                *ngIf="indentForm.get('categoryType')?.hasError('required') && indentForm.get('categoryType')?.touched">
                                                <span class="text-danger mt-4px d-block">Category is required!</span>
                                            </div>
                                        </div>
                                    </div> -->
                                    <div class="col-sm-12">
                                        <hr>
                                    </div>
                                </div>
                                <!-- 2nd ROW -->
                                <ng-container formArrayName="lstIndentItem">
                                    <ng-container *ngFor="let item of addItemslist.controls; let i = index">
                                        <ng-container [formGroupName]="i">
                                            <div class="card mb-3 border bg-light">
                                                <div class="card-body p-3">
                                                    <div class="row">
                                                        <div class="col-sm-6 mb-4">
                                                            <div class="position-relative">
                                                                <label for="itemName" class="form-label">Item<span
                                                                        [ngClass]="{'text-danger': this.indentForm.get('lstIndentItem')?.value[i]?.ItemGuid==null}">*</span></label>
                                                                <input type="text" id="itemName"
                                                                    class="form-control autocompleteInput"
                                                                    placeholder="Enter item name"
                                                                    (keyup)="search($event,i)"
                                                                    formControlName="ItemName" autocomplete="on"
                                                                    [ngClass]="{'is-invalid':item.get('ItemName')?.touched && item.get('ItemName')?.invalid}"
                                                                    [readonly]="this.indentForm.get('lstIndentItem')?.value[i]?.FromActiveSI">
                                                                <div class="spinLoader" *ngIf="SpinnerCheck">
                                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                                        viewBox="0 0 24 24" width="20" height="20">
                                                                        <path fill="none" d="M0 0h24v24H0z" />
                                                                        <path
                                                                            d="M12 2a1 1 0 0 1 1 1v3a1 1 0 0 1-2 0V3a1 1 0 0 1 1-1zm0 15a1 1 0 0 1 1 1v3a1 1 0 0 1-2 0v-3a1 1 0 0 1 1-1zm10-5a1 1 0 0 1-1 1h-3a1 1 0 0 1 0-2h3a1 1 0 0 1 1 1zM7 12a1 1 0 0 1-1 1H3a1 1 0 0 1 0-2h3a1 1 0 0 1 1 1zm12.071 7.071a1 1 0 0 1-1.414 0l-2.121-2.121a1 1 0 0 1 1.414-1.414l2.121 2.12a1 1 0 0 1 0 1.415zM8.464 8.464a1 1 0 0 1-1.414 0L4.93 6.344a1 1 0 0 1 1.414-1.415L8.464 7.05a1 1 0 0 1 0 1.414zM4.93 19.071a1 1 0 0 1 0-1.414l2.121-2.121a1 1 0 1 1 1.414 1.414l-2.12 2.121a1 1 0 0 1-1.415 0zM15.536 8.464a1 1 0 0 1 0-1.414l2.12-2.121a1 1 0 0 1 1.415 1.414L16.95 8.464a1 1 0 0 1-1.414 0z" />
                                                                    </svg>
                                                                </div>
                                                                <span class="text-danger position-absolute"
                                                                    *ngIf="item.get('ItemName')?.touched && item.get('ItemName')?.invalid && !this.indentForm.get('lstIndentItem')?.value[i].DuplicateItemCheck">
                                                                    Item is required!</span>
                                                                <div class="card card-body card-block autocompleteBox p-0"
                                                                    *ngIf="indentForm.value.IndentType=='PI'&&!this.indentForm.get('lstIndentItem')?.value[i]?.FromActiveSI">
                                                                    <div class="border-bottom p-2"
                                                                        *ngFor="let Indent of ItemsList"
                                                                        (click)="OnSelectedItem(Indent,i)">
                                                                        {{Indent.ItemName}}-({{Indent.CatalogNo?(Indent.CatalogNo):'N/A'}})
                                                                    </div>
                                                                </div>
                                                                <div class="card card-body card-block autocompleteBox p-0"
                                                                    *ngIf="indentForm.value.IndentType=='SI'">
                                                                    <div class="border-bottom p-2"
                                                                        *ngFor="let Indent of ItemsList  "
                                                                        (click)="OnSelectedItem(Indent,i)">
                                                                        {{Indent.ItemName}}-({{Indent.CatalogNo?(Indent.CatalogNo):'N/A'}})
                                                                    </div>
                                                                </div>
                                                                <div class="card card-body card-block autocompleteBox p-0"
                                                                    *ngIf="indentForm.value.IndentType=='B2BSI'">
                                                                    <div class="border-bottom p-2"
                                                                        *ngFor="let Indent of ItemsList  "
                                                                        (click)="OnSelectedItem(Indent,i)">
                                                                        {{Indent.ItemName}}-({{Indent.CatalogNo?(Indent.CatalogNo):'N/A'}})
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="text-danger position-absolute"
                                                                *ngIf="this.indentForm.get('lstIndentItem')?.value[i].DuplicateItemCheck ">
                                                                Please
                                                                select different item!</div>
                                                        </div>
                                                        <div class="col-sm-6 mb-4">
                                                            <div>
                                                                <label for="categoryType"
                                                                    class="form-label">Manufacturer
                                                                </label>
                                                                <select class="form-select" id="ddlcategoryType">
                                                                    <option
                                                                        *ngIf="this.indentForm.get('lstIndentItem')?.value[i].ManufactureName==null || this.indentForm.get('lstIndentItem')?.value[i].ManufactureName==''"
                                                                        selected disabled>Select manufacture</option>
                                                                    <option
                                                                        *ngIf="this.indentForm.get('lstIndentItem')?.value[i].ManufactureName">
                                                                        {{this.indentForm.get('lstIndentItem').value[i].ManufactureName}}
                                                                    </option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-6 mb-4">
                                                            <div>
                                                                <label for="categoryType"
                                                                    class="form-label">Machine</label>
                                                                <select class="form-select" id="categoryType">
                                                                    <option
                                                                        *ngIf="this.indentForm.get('lstIndentItem')?.value[i].MachineName==null || this.indentForm.get('lstIndentItem')?.value[i].MachineName=='' "
                                                                        selected disabled>Select machine</option>
                                                                    <option
                                                                        *ngIf="this.indentForm.get('lstIndentItem')?.value[i].MachineName">
                                                                        {{this.indentForm.get('lstIndentItem')?.value[i].MachineName}}
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-6 mb-4">
                                                            <div>
                                                                <label for="categoryType" class="form-label">Pack
                                                                    Size</label>
                                                                <select class="form-select" id="categoryType">
                                                                    <option
                                                                        *ngIf="this.indentForm.get('lstIndentItem')?.value[i].POSize==null"
                                                                        selected disabled>Select pack size</option>
                                                                    <option
                                                                        *ngIf="this.indentForm.get('lstIndentItem')?.value[i].POSize">
                                                                        {{this.indentForm.get('lstIndentItem')?.value[i].POSize}}
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <!-- <div class="col-sm-6 mb-4">
                                                            <div>
                                                                <label for="itemName" class="form-label">Issue
                                                                    Multiplier</label>
                                                                <input type="text" id="itemName" class="form-control"
                                                                    placeholder="Enter Issue multiplier">
                                                            </div>
                                                        </div> -->
                                                        <!-- <div class="col-sm-6 mb-4"
                                                            *ngIf="this.indentForm.value.IndentType!='SI'">
                                                            <div>
                                                                <div>
                                                                    <label for="categoryType"
                                                                        class="form-label">Supplier
                                                                        name
                                                                    </label>
                                                                    <select class="form-select" id="ddlcategoryType">
                                                                        <option
                                                                            *ngIf="this.indentForm.get('lstIndentItem')?.value[i].SupplierName==null|| this.indentForm.get('lstIndentItem')?.value[i].SupplierName==''"
                                                                            selected disabled>Select manufacture
                                                                        </option>
                                                                        <option
                                                                            *ngIf="this.indentForm.get('lstIndentItem')?.value[i].SupplierName">
                                                                            {{this.indentForm.get('lstIndentItem').value[i].SupplierName}}
                                                                        </option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div> -->
                                                        <div class="col-sm-3 col-md-6 col-lg-3 mb-4">
                                                            <label for="itemName" class="form-label">Qty <span
                                                                    [ngClass]="{'text-danger': this.indentForm.get('lstIndentItem')?.value[i].QtyNo==null}">*</span></label>
                                                            <input type="text" pattern="^(?!0\d)\d+(\.\d{1,2})?$"
                                                                [min]="1" class="form-control" formControlName="QtyNo"
                                                                [readonly]="this.indentForm.get('lstIndentItem')?.value[i].ItemGuid==null"
                                                                placeholder="Enter Qty" (keyup)="Change($event,i)" 
                                                                (keypress)="($event.charCode >= 48 && $event.charCode <= 57) || $event.charCode === 46" [min]="0"
                                                                [ngClass]="{'is-invalid':item.get('QtyNo')?.touched && item.get('QtyNo')?.invalid}"
                                                                (input)="ItemQuantityCalculation(i,this.indentForm.get('lstIndentItem')?.value[i].ItemGuid)">
                                                            <span class="text-danger"
                                                                *ngIf="item.get('QtyNo')?.touched && item.get('QtyNo')?.invalid">
                                                                Qty is required and must be greater than 0!</span>
                                                        </div>
                                                        <div class="col-sm-6 col-lg-3 mb-4">
                                                            <div>
                                                                <label for="itemName" class="form-label">Lab required
                                                                    date
                                                                    <span
                                                                        [ngClass]="{'text-danger': !this.indentForm.get('lstIndentItem')?.value[i].LabDate}">*</span>
                                                                </label>
                                                                <div class="input-group" (click)="dpFromDate.toggle()">
                                                                    <input #dpFromDate="ngbDatepicker" ngbDatepicker
                                                                        class="form-control" readonly
                                                                        placeholder="dd-mm-yyyy" [minDate]="newDate"
                                                                        name="dpFromDate"
                                                                        [ngClass]="{'is-invalid': item.get('LabDate')?.touched && this.indentForm.get('lstIndentItem')?.value[i].LabDate==null}"
                                                                        formControlName="LabDate" [container]="'body'">
                                                                    <button class="input-group-text" type="button">
                                                                        <i
                                                                            class="feather icon-calendar icon-md text-muted"></i>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                            <span class="text-danger"
                                                                *ngIf="item.get('LabDate')?.touched && this.indentForm.get('lstIndentItem')?.value[i].LabDate==null && this.IndentGuid==''">
                                                                Lab require date is required!
                                                            </span>
                                                            <span class="text-danger"
                                                                *ngIf="this.indentForm.get('lstIndentItem')?.value[i].LabDate=='' && IndentGuid!=''">
                                                                Lab require date is required!
                                                            </span>
                                                        </div>
                                                        <div class="col-sm-3 col-md-6 col-lg-3 mb-4" *ngIf="(this.indentForm.get('lstIndentItem')?.value[i].ReqQuantity >0 && this.indentForm.get('lstIndentItem')?.value[i].IsReason==true && this.indentForm.get('lstIndentItem')?.value[i]?.ItemGuid) || (IndentGuid && this.indentForm.value.IndentType === 'SI' && IndentItemDetails[i]?.Reason)">
                                                            <label for="itemName" class="form-label">Reason <span
                                                                    [ngClass]="{'text-danger': !this.indentForm.get('lstIndentItem')?.value[i].Reason}">*</span></label>
                                                            <input type="text"                                                              
                                                                [min]="1" class="form-control" formControlName="Reason"
                                                                placeholder="Enter reason" 
                                                                [ngClass]="{'is-invalid':item.get('Reason')?.touched && item.get('Reason')?.invalid}" (input)="Onclickreason(i)"
                                                                >
                                                            <span class="text-danger"
                                                                *ngIf="item.get('Reason')?.touched && item.get('Reason')?.invalid">
                                                                Reason is required!</span>
                                                        </div>
                                                        <div class="">
                                                            <double-scroll>
                                                                <!-- <div class="table-responsive col-sm-12 px-0 mx-auto" style="max-width: 98%;"> -->
                                                                <table class="table bg-white"
                                                                    *ngIf="indentForm.value.IndentType!=''">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>{{authservice.LoggedInUser.B2BTYPE=='true'||authservice.LoggedInUser.B2BTYPE==true?'Store Approved Qty':'Store In Hand Qty'}}</th>
                                                                            <th>In PO Qty</th>
                                                                            <th>Qty</th>
                                                                            <!-- <th>Checked Qty</th> -->
                                                                            <!-- <th>Approved Qty</th> -->
                                                                            <th>Unit</th>
                                                                            <!-- <th>Item Type</th> -->
                                                                            <th>HSN Code</th>
                                                                            <th>Catalog No</th>
                                                                            <!-- <th>Item Code</th> -->
                                                                            <th *ngIf="this.indentForm.get('lstIndentItem')?.value[i].ItemGuid !=null && (this.authservice.LoggedInUser.DEFAULTROLES == 'STORE ADMIN' || this.authservice.LoggedInUser.DEFAULTROLES == 'ADMIN')">Action</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <tr>
                                                                            <td>{{this.indentForm.get('lstIndentItem')?.value[i].InHandQuantity==null?'N/A':this.indentForm.get('lstIndentItem')?.value[i].InHandQuantity}}
                                                                            </td>
                                                                            <td>{{this.indentForm.get('lstIndentItem')?.value[i].InPOQuantity}}
                                                                            </td>
                                                                            <td>{{this.indentForm.get('lstIndentItem')?.value[i].QtyNo}}
                                                                            </td>
                                                                            <td>{{this.indentForm.get('lstIndentItem')?.value[i].MajorUnitName}}
                                                                            </td>
                                                                            <td>{{this.indentForm.get('lstIndentItem')?.value[i].HSNCode}}
                                                                            </td>
                                                                            <td>{{this.indentForm.get('lstIndentItem')?.value[i].CatlogNo}}
                                                                            </td>
                                                                            <td>
                                                                                <a *ngIf="this.indentForm.get('lstIndentItem')?.value[i].ItemGuid !=null && (this.authservice.LoggedInUser.DEFAULTROLES == 'STORE ADMIN' || this.authservice.LoggedInUser.DEFAULTROLES == 'ADMIN')"
                                                                                    class="btn btn-outline-primary btn-xs me-1"
                                                                                    target="_blank"
                                                                                    [routerLink]="['/items/view-item',this.indentForm.get('lstIndentItem')?.value[i].ItemGuid]"><span
                                                                                        class="feather icon-eye" ></span>
                                                                                    View </a>
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                                <!-- </div> -->
                                                            </double-scroll>
                                                        </div>
                                                        <div class="col-12 mt-3">
                                                            <div class="d-flex align-items-center gap-3">
                                                                <div class="mb-3" (click)="removeItems(i)"
                                                                    *ngIf="i > 0">
                                                                    <button class="btn-danger btn">
                                                                        <span class="feather icon-close"> </span> Remove
                                                                        item
                                                                    </button>
                                                                </div>
                                                                <!-- *ngIf="i == addItemslist.controls.length - 1" -->
                                                                <div class="mb-3" (click)="AddItems()"
                                                                    *ngIf="i == addItemslist.controls.length - 1 && lstLocationItems?.length>0">
                                                                    <button class="btn-primary btn">
                                                                        <span class="feather icon-plus"> </span> Add
                                                                        item
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </ng-container>
                                    </ng-container>
                                </ng-container>
                            </div>
                            <div class="col-lg-3 col-xl-2 offset-xl-1">
                                <div class="card mb-3">
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>Budget Amount</div>
                                            <div class="fw-bold  text-primary">0</div>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>Month Amount</div>
                                            <div class="fw-bold  text-primary">0</div>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>PI Amount</div>
                                            <div class="fw-bold  text-primary">0</div>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>SI Amount</div>
                                            <div class="fw-bold  text-primary">0</div>
                                        </li>
                                    </ul>
                                </div>
                                <div class="card">
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>Buffer Percentage</div>
                                            <div class="fw-bold  text-primary">0</div>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>Average Consumption</div>
                                            <div class="fw-bold  text-primary">0</div>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>Wastage Percentage</div>
                                            <div class="fw-bold  text-primary">0</div>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>In Hand Qty</div>
                                            <div class="fw-bold  text-primary">0</div>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>Pending PO Qty (current month)</div>
                                            <div class="fw-bold  text-primary">0</div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                <hr />
                            </div>
                            <div class="col-sm-6 mb-4">
                                <div>
                                    <label for="remarks" class="form-label">Remarks<span
                                            [ngClass]="{'text-danger': this.indentForm.get('Remark')?.value==''}">
                                            *</span></label>
                                    <input type="text" id="remarks" class="form-control" placeholder="Enter Remarks"
                                        [maxlength]="200" formControlName="Remark"
                                        [ngClass]="{'is-invalid':indentForm.get('Remark')?.touched && indentForm.get('Remark')?.invalid}" />
                                </div>
                                <span class="text-danger"
                                    *ngIf="indentForm.get('Remark')?.touched && indentForm.get('Remark')?.invalid">
                                    Remarks is required!</span>
                            </div>
                        </div>
                    </ng-container>
                    <!-- Shimmer Loading UI -->
                    <div class="row" *ngIf="shimmerVisible">
                        <div class="col-12 col-sm-6 col-md-6 col-xl-9 grid-margin">
                            <div class="row">
                                <div class="col-md-12 col-xl-4">
                                    <div>
                                        <div class="shimmerBG"
                                            style="width: 190px; height: 15px; border-radius: 5px;margin-bottom:10px">
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6 col-xl-3 d-flex">
                                                <div class="shimmerBG"
                                                    style="width: 18px; height: 18px; border-radius:50px;margin-bottom:3px">
                                                </div>
                                                <div class="shimmerBG"
                                                    style="width: 45px; height: 15px; border-radius:5px;margin-left:10px">
                                                </div>
                                            </div>
                                            <div class="col-md-6 col-xl-6 d-flex">
                                                <div class="shimmerBG"
                                                    style="width: 18px; height: 18px; border-radius:50px;margin-bottom:3px">
                                                </div>
                                                <div class="shimmerBG"
                                                    style="width: 45px; height: 15px; border-radius:5px;margin-left:10px">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-4">
                                <div class="col-sm-6 col-md-6" *ngFor="let dummyLoop of [].constructor(2)">
                                    <div class="mb-3">
                                        <label class="label mb-1">
                                            <div class="shimmerBG formLable"></div>
                                        </label>
                                        <div class="form-control form-control-sm">
                                            <div class="shimmerBG formInput"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-sm-6 col-md-6 col-xl-2 offset-xl-1 grid-margin">
                            <div class="card">
                                <div class="card-body">
                                    <ul style="list-style-type: none;padding:0;margin-bottom:0">
                                        <li *ngFor="let dummyLoop of [].constructor(5)" style="padding-bottom: 10px;">
                                            <div class="row">
                                                <div class="col-md-12 col-xl-9">
                                                    <div>
                                                        <div class="shimmerBG"
                                                            style="width: 100%; height: 15px; border-radius: 5px;margin-bottom:3px">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-12 col-xl-3">
                                                    <div>
                                                        <div class="shimmerBG"
                                                            style="width: 100%; height: 15px; border-radius: 5px;margin-bottom:3px">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Shimmer Loading UI -->
                    <div class="card-footer">
                        <div class="row" *ngIf="!shimmerVisible">
                            <div class="col-sm-12 text-end">
                                <button type="button" class="btn btn-secondary me-2" [disabled]="!FormChanged"
                                    (click)="FormReset()">Reset</button>
                                <button type="button" class="btn btn-primary submit"
                                    [disabled]="!FormChanged || indentForm.invalid"
                                    (click)="SaveIndentDetails()">{{IndentGuid?'Update':'Save'}}</button>
                            </div>
                        </div>
                        <!--Shimmer UI -->
                        <ng-container *ngIf="shimmerVisible">
                            <tr *ngFor="let dummyLoop of [].constructor(1)"
                                class="align-items-end align-self-end d-flex justify-content-end">
                                <td>
                                    <div class="d-flex text-end">
                                        <div class="shimmerBG line" style="margin-right: 5px;width: 80px;height: 38px;">
                                        </div>
                                        <div class="shimmerBG line" style="width: 80px;height: 38px;"></div>
                                    </div>
                                </td>
                            </tr>
                        </ng-container>
                        <!--Shimmer UI -->
                    </div>
                </form>
            </div>

        </div>
    </div>
    <ng-template #Request let-modal>
  <div class="modal-header">
      <h5 class="modal-title" id="exampleModalLabel">Request quantity</h5>
  </div>
  <div class="modal-body">
      <div class="row">
          <div class="col-sm-12">
              <div class="mb-3">
                  <label for="itemName" class="form-label">Are you sure you want to request a quantity that you already have? 
                    Please consume the available quantity before making a new request. If you still wish to proceed with the request,
                    kindly provide a reason for the additional quantity needed to continue.
                      </label>
              </div>
          </div>
      </div>
  </div>
  <div class="modal-footer">    
      <button type="button" class="btn btn-secondary me-2" (click)="modal.close('by: close icon');resonClick()">
          No
      </button>
      <button type="button" class="btn btn-primary submit"
          (click)="modal.close('by: close icon')"  [routerLink]="['/dp-consumption']">Yes</button>
  </div>
</ng-template>
<ng-template #DispatchRequest let-modal>
    <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Request quantity</h5>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-sm-12">
                <div class="mb-3">
                    <label for="itemName" class="form-label">Are you sure you want to request a quantity that you already you haven't received? 
                        Please consume the available quantity before making a new request. If you still wish to proceed with the request,
                        Kindly provide a reason for the additional quantity needed to continue.
                        </label>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">    
        <button type="button" class="btn btn-secondary me-2" (click)="modal.close('by: close icon');resonClick()">
            No
        </button>
        <button type="button" class="btn btn-primary submit"
            (click)="modal.close('by: close icon')"  [routerLink]="['/material-dispatched']">Yes</button>
    </div>
  </ng-template>

  <ng-template #PIRequest let-modal>
    <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Request quantity</h5>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-sm-12">
                <div class="mb-3">
                    <label for="itemName" class="form-label">Are you sure you want to request a {{ ItemNameList }} quantity that you already have?
                        Please consume the available quantity before making a new request. If you still wish to proceed with the request,
                        Kindly provide a reason for the additional quantity needed to continue.
                        </label>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">    
        <button type="button" class="btn btn-secondary me-2" (click)="modal.close('by: close icon');resonClick()">
            No
        </button>
        <button type="button" class="btn btn-primary submit"
            (click)="modal.close('by: close icon')"  [routerLink]="['/material-dispatched']">Yes</button>
    </div>
  </ng-template>
</div>